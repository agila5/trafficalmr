---
title: "SaferActive Report 2: Scenarios"
author: Institute for Transport Studies
output: bookdown::html_vignette2
vignette: >
  %\VignetteIndexEntry{SaferActive Report 2: Scenarios}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
bibliography: saferactive.bib
pkgdown:
  as_is: true
  set_null_theme: false
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  echo = FALSE
)
```

```{r setup}
library(trafficalmr)
```

# Software development

One of the objectives of the project was to develop software to enable access to data on traffic calming interventions.
We have progressed with the development of the `trafficalmr` package for reproducible road safety analysis, supporting the project and other projects on road safety.
We would like feedback from stakeholders: is it easy to use? what additional functionality would you like to see? The list of functions provided by the package can be found here: https://saferactive.github.io/trafficalmr/reference/index.html

# Temporal analysis

We analysed the DfT's manual traffic count data to explore its potential to provide estimates of the geographic distribution of cycling uptake over time.
There is an uneven number of locations where annual average daily flow estimates are available, as shown in Figure \@ref(fig:aadf-counts-per-year).

```{r aadf-counts-per-year, fig.cap="AADF counts per year in the DfT's traffic counter dataset", out.width="49%", fig.show='hold'}
knitr::include_graphics(c(
  "https://raw.githubusercontent.com/saferactive/saferactive/master/figures/aadf-counts-per-year.png",
  "https://raw.githubusercontent.com/saferactive/saferactive/master/figures/aadf-counts-per-year-2-plus.png"
  ))
```

Taking 3,049 count locations which had continuous readings in the 10 years from 2010 to 2019 (representing 35% of the total counts in these years), we were able to generate estimates of cycling uptake at the local authority level.
These are presented, relative to 2011 cycling levels, in Figure \@ref(fig:aadf-uptake-2011-multiplier-line-mean), showing an upward trend in cycling uptake in the years 2010-2014. 

```{r aadf-uptake-2011-multiplier-line-mean, fig.cap="Cycling uptake estimates for all local authorities in Great Britain. Black line width represents the number of counters in each local authority, the white line represents no cycling uptake, and the red line is the weighted mean for all cycle counters from 2010 to 2019.", out.width="100%"}
knitr::include_graphics("https://raw.githubusercontent.com/saferactive/saferactive/master/figures/aadf-uptake-2011-multiplier-line-mean.png")
```

We can further investigate cycle flows on different types of road. For count points with continuous readings in the years 2010-2019, 75% are on 'C' and unclassified roads, 24% on 'B' roads, and less than 1% on principal or trunk 'A' roads. By comparison, of all count points during these years, 47% of counts are on 'C' and unclassified roads, 14% on 'B' roads, 31% on principal 'A' roads and 8% on trunk 'A' roads.

Of the road types studied, mean AADF is highest on Principal 'A' roads at 214 cycles per day, and lowest on Trunk 'A' roads at 2.4 cycles per day. On Trunk 'A' roads, zero cyclists were recorded at 34% of counts; many of these may represent locations on major national routes that are unsuitable for most cyclists. However, the increase in cycling uptake during the years 2010-2014 corresponds to counts from minor roads ('B', 'C' and unclassified roads). These roads that 

Using all cycle count points in London over the years 2010-2019, we produced a GAM model 

Preliminary results, based on a General Additive Model (GAM) are shown in Figure \@ref(fig:gam1).

```{r gam1, fig.cap="Preliminary estimates of cycling uptake in London boroughs relative to 2011 levels, 2000-2018. A selection of boroughs of interest are highlighted for reference.", echo=FALSE}
knitr::include_graphics("https://raw.githubusercontent.com/saferactive/saferactive/master/figures/cycle-uptake-la-london-smoothed.png")
```

Building on results for London, we scaled-up the approach to provide nationwide spatio-temporal estimates of cycling. 

The national GAM model has smooth terms for the variables year, space and road category.


figure


[JT content here]



# Geographic data analysis

Building on methods we initially developed for the [CyIPT](https://www.cyipt.bike/) project, we have developed new techniques for allocating crashes to features on the road network, such as junctions and road sections.
Preliminary results comparing CyIPT results and results from this project are shown in Figure \@ref(fig:cyipt-crash).

```{r cyipt-crash, fig.cap="CyIPT methods for allocating crashes to juctions (left) compared with preliminary results of updated methods developed for the SaferActive project (right).", out.width="40%", fig.show='hold', echo=FALSE}
knitr::include_graphics(c(
  "https://raw.githubusercontent.com/saferactive/saferactive/master/figures/cyipt-crashes1-2.png",
  "https://raw.githubusercontent.com/saferactive/saferactive/master/figures/cyipt-crashes2.png"
))
```


The method works as follows.
[MM content here.]

# Analysis of data on traffic calming


# Scenario development


# Next steps



